@model doma.Models.DonHang

@{
    ViewBag.Title = "Chi tiết đơn hàng: " + Model.ID;
    long total = 0;
    int _cd = (int)(Model.ThoiGianGiao - DateTime.Now).TotalDays;
}
<div class="box">
    <div class="box-footer">
        <span style="margin-right: 20px;">Quay lại </span>
        <a class="btn btn-primary" href="../../admin">Admin</a>
    </div>
</div>

<div class="box box-info">
    <div class="box-header">
        <h3>Đơn hàng: Mã @Model.ID</h3>
    </div>

    <div class="box-body">
        <h4>Thông tin</h4>


        <div class="col-md-3">
            <img src="@Model.AspNetUser.avatar" style="width: 200px;" />
        </div>
        <div class="col-md-9">
            <table class="table table-bordered">
                <tr>
                    <td>Người đặt</td>
                    <td><strong>@Model.AspNetUser.HoTen</strong></td>
                </tr>

                <tr>
                    <td>Điện thoại</td>
                    <td><strong>@Model.SoDienThoai</strong></td>
                </tr>

                <tr>
                    <td>Địa chỉ giao</td>
                    <td><strong>@Model.DiaChiGiao</strong></td>
                </tr>

                <tr>
                    <td>Ngày đặt</td>
                    <td><strong>@Model.NgayTao</strong></td>
                </tr>

                <tr>
                    <td>Ngày giao</td>
                    <td><strong>@Model.ThoiGianGiao - <strong style="color:red;">Còn @_cd ngày</strong></strong></td>
                </tr>
                <tr>
                    <td>Tình trạng</td>
                    <td>
                        @switch (Model.TinhTrang)
                        {
                            case 0:
                                <span class="badge bg-gray">Dã hủy</span>
                                break;
                            case 1:
                            <span class="badge bg-red">Mới, đang đợi gọi xác nhận</span>
                                break;
                            case 2:
                            <span class="badge bg-green-active">Đã gọi và đang chuẩn bị hàng</span>
                                break;
                            case 3:
                            <span class="badge bg-blue-active">Đang gửi đi</span>
                                break;
                            case 4:
                            <span class="badge bg-blue">Đã gửi đi và nhận tiền</span>
                                break;
                        }
                    </td>
                </tr>
            </table>
        </div>


        <h4>Chi tiết đơn hàng</h4>
        <hr />

        <table class="table table-bordered table-hover">
            <thead>
                <tr>
                    <td><strong>Mã</strong></td>
                    <td><strong>Tên</strong></td>
                    <td><strong>Đơn giá</strong></td>
                    <td><strong>Số lượng</strong></td>
                    <td><strong>Thành tiên</strong></td>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.ChiTietDonHangs)
                {
                    <tr>
                        <td>@item.IDSanPham</td>
                        <td>@item.SanPham.Ten</td>
                        <td>@item.SanPham.DioGia</td>
                        <td>@item.SoLuong</td>
                        <td style="color: red; text-align: right;">@((@item.SanPham.DioGia * @item.SoLuong).ToString("#,##"))</td>
                        @{
                    total += item.SanPham.DioGia * item.SoLuong;
                        }
                    </tr>
                }

                <tr>
                    <td colspan="4">Tổng tiền</td>
                    <td style="color: red; text-align: right;"><strong>@total.ToString("#,##")</strong></td>
                </tr>
            </tbody>
        </table>

    </div>

    <div class="box-footer">
        <a class="btn btn-success" href="../../admin/doitrangthaidonhang?id=@Model.ID&&tinhtrang=2" style="margin-right: 20px;">Đã gọi xác nhận</a>
        <a class="btn btn-primary" href="../../admin/doitrangthaidonhang?id=@Model.ID&&tinhtrang=3" style="margin-right: 20px;">Đang gửi đi</a>
        <a class="btn btn-danger" href="../../admin/doitrangthaidonhang?id=@Model.ID&&tinhtrang=4">Đã thanh toán và gửi hàng</a>
        <a class="btn btn-default" href="../../admin/doitrangthaidonhang?id=@Model.ID&&tinhtrang=0" style="float:right;">Hủy đơn hàng</a>
    </div>
</div>

